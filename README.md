# Wireguard / WARP Relay

<p align="left">
  <img src="img/logo.png" alt="WARP Relay Logo" width="250">
</p>
<p align="left">
  <b>Relay-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Wireguard –∏ Cloudflare WARP</b>
</p>

<p align="left">
  <a href="#-–æ–ø–∏—Å–∞–Ω–∏–µ">–û–ø–∏—Å–∞–Ω–∏–µ</a> ‚Ä¢
  <a href="#-–¥–ª—è-–∫–æ–≥–æ">–î–ª—è –∫–æ–≥–æ</a> ‚Ä¢
  <a href="#-—Å–∏—Å—Ç–µ–º–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è">–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</a> ‚Ä¢
  <a href="#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</a> ‚Ä¢
  <a href="#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</a> ‚Ä¢
  <a href="#-–ª–∏—Ü–µ–Ω–∑–∏—è">–õ–∏—Ü–µ–Ω–∑–∏—è</a>
</p>

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

**WARP Relay** ‚Äî —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –≥–¥–µ –ø–æ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–µ—â–µ–Ω –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –≤–Ω–µ—à–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º (–≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç), –Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º VPN-—Å–µ—Ä–≤–µ—Ä–∞–º (Wireguard –∏–ª–∏ Cloudflare WARP).

> ‚ö†Ô∏è **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í —Å–∫—Ä–∏–ø—Ç–∞—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥—Ä–µ—Å `engage.cloudflareclient.com` ‚Äî —ç—Ç–æ endpoint –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ Cloudflare WARP, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–µ–¥—ë–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã Wireguard / WARP Relay. –ê–≤—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ –∫–æ–º–ø–∞–Ω–∏–∏ Cloudflare, Inc. –í –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–Ω—Ç—É—Ä–∞—Ö –≤—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π VPN —Å–µ—Ä–≤–µ—Ä, —É–∫–∞–∑–∞–≤ –µ–≥–æ IP-–∞–¥—Ä–µ—Å –∏ –ø–æ—Ä—Ç –≤—Ä—É—á–Ω—É—é.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–í —Å–µ—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è **Relay-—Å–µ—Ä–≤–µ—Ä**, –∏–º–µ—é—â–∏–π –¥–æ—Å—Ç—É–ø –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏. –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ –≤–Ω–µ—à–Ω–µ–º—É –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º—É VPN-—Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP-–∞–¥—Ä–µ—Å Relay-—Å–µ—Ä–≤–µ—Ä–∞.

<p align="left">
  <img src="img/warp-relay.png" alt="–°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã WARP Relay" width="450">
</p>

**–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ö–µ–º—ã:**

–ù–∞ —Å—Ö–µ–º–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ `192.168.11.0/24`. –†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (`192.168.11.101`, `192.168.11.102`) –Ω–µ –∏–º–µ—é—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –û–¥–Ω–∞–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º—É VPN-—Å–µ—Ä–≤–µ—Ä—É Wireguard, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–º—É –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –æ—Ñ–∏—Å–µ —Å –ø—É–±–ª–∏—á–Ω—ã–º IP-–∞–¥—Ä–µ—Å–æ–º `40.30.20.10`.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç **Wireguard / WARP Relay —Å–µ—Ä–≤–µ—Ä** (`192.168.11.10`), –∏–º–µ—é—â–∏–π –≤—ã—Ö–æ–¥ –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç. –ù–∞ Relay-—Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ iptables –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞:

```bash
export TAG="WR_RULE"
export SRC_IP=192.168.11.10
export DST_IP=40.30.20.10
export SRC_PORT=2288
export DST_PORT=51820

echo "net.ipv4.ip_forward=1" > /etc/sysctl.d/ipv4-forwarding.conf
sysctl -w net.ipv4.ip_forward=1

iptables -t nat -A PREROUTING \
  -d ${SRC_IP} -p udp --dport ${SRC_PORT} \
  -j DNAT --to-destination ${DST_IP}:${DST_PORT} \
  -m comment --comment "${TAG}"

iptables -t nat -A POSTROUTING \
  -p udp -d ${DST_IP} --dport ${DST_PORT} \
  -j MASQUERADE \
  -m comment --comment "${TAG}"

iptables -A FORWARD -p udp -d ${DST_IP} --dport ${DST_PORT} -j ACCEPT -m comment --comment "${TAG}"
iptables -A FORWARD -p udp -s ${DST_IP} --sport ${DST_PORT} -j ACCEPT -m comment --comment "${TAG}"

echo iptables-persistent iptables-persistent/autosave_v4 boolean true | sudo debconf-set-selections
echo iptables-persistent iptables-persistent/autosave_v6 boolean true | sudo debconf-set-selections
sudo DEBIAN_FRONTEND=noninteractive apt install -y iptables-persistent
iptables-save > /etc/iptables/rules.v4
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º—É VPN –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∞–¥—Ä–µ—Å Relay-—Å–µ—Ä–≤–µ—Ä–∞ `192.168.11.10:2288`. –í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≤–Ω–µ—à–Ω–∏–π Wireguard-—Å–µ—Ä–≤–µ—Ä `40.30.20.10:51820`, –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –∏–º–µ—é—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç.

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- üîí **–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞** ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –≤–Ω–µ—à–Ω–µ–º—É VPN —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π relay
- üè¢ **–§–∏–ª–∏–∞–ª—ã –∏ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –æ—Ñ–∏—Å—ã** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞
- üõ°Ô∏è **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ò–ë-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º** ‚Äî –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π —Å–µ—Ä–≤–µ—Ä
- ‚òÅÔ∏è **Cloudflare WARP** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WARP —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π relay –¥–ª—è Zero Trust –¥–æ—Å—Ç—É–ø–∞

---

## üë• –î–ª—è –∫–æ–≥–æ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:

- **–°–µ—Ç–µ–≤—ã—Ö –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **–°–∏—Å—Ç–µ–º–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤** ‚Äî —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤
- **DevOps / SRE** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É

---

## üíª –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ/—Å–µ—Ä–≤–µ—Ä—É

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ú–∏–Ω–∏–º—É–º | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
|----------|---------|---------------|
| CPU | 1 vCPU | 2 vCPU |
| RAM | 512 MB | 1 GB |
| –î–∏—Å–∫ | 5 GB | 10 GB |
| –°–µ—Ç—å | 1 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –¥–æ—Å—Ç—É–ø–æ–º –≤–æ –≤–Ω–µ—à–Ω—é—é —Å–µ—Ç—å | 2 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π + –≤–Ω–µ—à–Ω–∏–π) |

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

- **Ubuntu** 20.04 LTS / 22.04 LTS / 24.04 LTS
- **Debian** 11 / 12
- –î—Ä—É–≥–∏–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã –Ω–∞ –±–∞–∑–µ Debian (—Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –∫–æ–º–∞–Ω–¥)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º—É –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é

- `iptables` ‚Äî –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª NAT –∏ forwarding
- `curl` ‚Äî –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ IP-–∞–¥—Ä–µ—Å–∞
- `iptables-persistent` ‚Äî –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- `getent` ‚Äî –¥–ª—è DNS-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ –≤—Ö–æ–¥–∏—Ç –≤ –±–∞–∑–æ–≤—É—é –ø–æ—Å—Ç–∞–≤–∫—É)

### –°–µ—Ç–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ –î–æ—Å—Ç—É–ø –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ (–∏–Ω—Ç–µ—Ä–Ω–µ—Ç) –¥–ª—è Relay-—Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ UDP –ø–æ—Ä—Ç 4500 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –í–∫–ª—é—á–µ–Ω IP forwarding –≤ —è–¥—Ä–µ Linux

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
curl -fsSL https://raw.githubusercontent.com/bekirovtimur/warp-relay/main/wr.sh | sudo bash
```

–ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
wget https://raw.githubusercontent.com/bekirovtimur/warp-relay/main/wr.sh
chmod +x wr.sh
sudo ./wr.sh
```

### –ü—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é)

**–í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî –æ–¥–∏–Ω UDP-–ø–æ—Ä—Ç (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º)**

```bash
curl -fsSL https://raw.githubusercontent.com/bekirovtimur/warp-relay/main/simple.sh | sudo bash
```

**–í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ UDP-–ø–æ—Ä—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–º—É–ª—å—Ç–∏–ø–æ—Ä—Ç)**

```bash
curl -fsSL https://raw.githubusercontent.com/bekirovtimur/warp-relay/main/simple_multiport.sh | sudo bash
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–±—Ä–æ—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö UDP-–ø–æ—Ä—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ—Ä—Ç—ã Cloudflare WARP):
```
500   854   859   864   878   880   890   891   894   903
908   928   934   939   942   943   945   946   955   968
987   988   1002  1010  1014  1018  1070  1074  1180  1387
1701  1843  2371  2408  2506  3138  3476  3581  3854  4177
4198  4233  4500  5279  5956  7103  7152  7156  7281  7559
8319  8742  8854  8886
```
–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Relay-—Å–µ—Ä–≤–µ—Ä—É –ø–æ –ø–æ—Ä—Ç—É X,
—Ç–æ —Ç—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –Ω–∞ —Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –ø–æ—Ä—Ç X.

---

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `wr.sh`

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å –º–µ–Ω—é –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```bash
sudo ./wr.sh
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ü–∏–∏:**

1. **–ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (Cloudflare UDP 4500)** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Cloudflare WARP
2. **–í–≤–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Ä—É—á–Ω—É—é** ‚Äî —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ –ø–æ—Ä—Ç–æ–≤ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. **–ü–æ–∫–∞–∑–∞—Ç—å Relay –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∞–π—Ä–≤–æ–ª–ª–∞** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö iptables –ø—Ä–∞–≤–∏–ª
4. **–û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (—É–¥–∞–ª–µ–Ω–∏–µ)** ‚Äî –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ø—Ä–∞–≤–∏–ª
5. **–í—ã—Ö–æ–¥** ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞

### –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç `simple.sh`

–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é:

```bash
sudo ./simple.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–Ω–µ—à–Ω–∏–π IP —Å–µ—Ä–≤–µ—Ä–∞ (`ifconfig.me`)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç IP Cloudflare WARP (`engage.cloudflareclient.com`)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç iptables –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è UDP –ø–æ—Ä—Ç–∞ 4500
- –í–∫–ª—é—á–∞–µ—Ç IP forwarding
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏

### –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
# –í–∫–ª—é—á–∏—Ç—å IP forwarding
echo "net.ipv4.ip_forward=1" > /etc/sysctl.d/ipv4-forwarding.conf
sysctl -w net.ipv4.ip_forward=1

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å iptables (–ø—Ä–∏–º–µ—Ä –¥–ª—è Cloudflare WARP)
SRC_IP="YOUR_SERVER_IP"
DST_IP="$(getent ahostsv4 engage.cloudflareclient.com | awk '{print $1; exit}')"
SRC_PORT=4500
DST_PORT=4500

# DNAT –ø—Ä–∞–≤–∏–ª–æ
iptables -t nat -A PREROUTING \
  -d ${SRC_IP} -p udp --dport ${SRC_PORT} \
  -j DNAT --to-destination ${DST_IP}:${DST_PORT} \
  -m comment --comment "WR_RULE"

# MASQUERADE –ø—Ä–∞–≤–∏–ª–æ
iptables -t nat -A POSTROUTING \
  -p udp -d ${DST_IP} --dport ${DST_PORT} \
  -j MASQUERADE \
  -m comment --comment "WR_RULE"

# –†–∞–∑—Ä–µ—à–∏—Ç—å forwarding
iptables -A FORWARD -p udp -d ${DST_IP} --dport ${DST_PORT} -j ACCEPT -m comment --comment "WR_RULE"
iptables -A FORWARD -p udp -s ${DST_IP} --sport ${DST_PORT} -j ACCEPT -m comment --comment "WR_RULE"

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞
echo iptables-persistent iptables-persistent/autosave_v4 boolean true | sudo debconf-set-selections
echo iptables-persistent iptables-persistent/autosave_v6 boolean true | sudo debconf-set-selections
sudo DEBIAN_FRONTEND=noninteractive apt install -y iptables-persistent
iptables-save > /etc/iptables/rules.v4
```

---

## üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Cloudflare WARP

```bash
# –ù–∞ Relay-—Å–µ—Ä–≤–µ—Ä–µ
sudo ./wr.sh
# –í—ã–±—Ä–∞—Ç—å –ø—É–Ω–∫—Ç 1 - –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞

# –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ WARP:
# Endpoint: IP_–∞–¥—Ä–µ—Å_Relay_—Å–µ—Ä–≤–µ—Ä–∞:4500
```

### –ü—Ä–∏–º–µ—Ä 2: –ö–∞—Å—Ç–æ–º–Ω—ã–π Wireguard —Å–µ—Ä–≤–µ—Ä

```bash
# –ù–∞ Relay-—Å–µ—Ä–≤–µ—Ä–µ
sudo ./wr.sh
# –í—ã–±—Ä–∞—Ç—å –ø—É–Ω–∫—Ç 2 - –í–≤–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—Ä—É—á–Ω—É—é
# –í–≤–µ—Å—Ç–∏ IP –≤–∞—à–µ–≥–æ Wireguard —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω—É–∂–Ω—ã–π –ø–æ—Ä—Ç

# –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Wireguard:
# Endpoint: IP_–∞–¥—Ä–µ—Å_Relay_—Å–µ—Ä–≤–µ—Ä–∞:–ü–û–†–¢
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ù–∞ Relay-—Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞
sudo ./wr.sh
# –í—ã–±—Ä–∞—Ç—å –ø—É–Ω–∫—Ç 3 - –ü–æ–∫–∞–∑–∞—Ç—å Relay –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∞–π—Ä–≤–æ–ª–ª–∞

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
iptables -t nat -L -n -v | grep WR_RULE
iptables -L FORWARD -n -v | grep WR_RULE
```

---

## üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ / –û—Ç–∫–∞—Ç

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:

```bash
sudo ./wr.sh
# –í—ã–±—Ä–∞—Ç—å –ø—É–Ω–∫—Ç 4 - –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (—É–¥–∞–ª–µ–Ω–∏–µ)
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ —Å —Ç–µ–≥–æ–º WR_RULE
iptables -t nat -S | grep "WR_RULE" | sed 's/^-A/-D/' | while read rule; do
    iptables -t nat $rule
done

iptables -S | grep "WR_RULE" | sed 's/^-A/-D/' | while read rule; do
    iptables $rule
done

# –û—Ç–∫–ª—é—á–∏—Ç—å IP forwarding
echo "net.ipv4.ip_forward=0" > /etc/sysctl.d/ipv4-forwarding.conf
sysctl -w net.ipv4.ip_forward=0

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
iptables-save > /etc/iptables/rules.v4
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
warp-relay/
‚îú‚îÄ‚îÄ img/
‚îÇ   ‚îú‚îÄ‚îÄ logo.png              # –õ–æ–≥–æ—Ç–∏–ø –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ warp-relay.png        # –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ warp-relay.drawio     # –ò—Å—Ö–æ–¥–Ω–∏–∫ —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ simple.sh                 # –ü—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ–¥–∏–Ω UDP-–ø–æ—Ä—Ç)
‚îú‚îÄ‚îÄ simple_multiport.sh       # –ü—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–Ω–µ—Å–∫–æ–ª—å–∫–æ UDP-–ø–æ—Ä—Ç–æ–≤)
‚îú‚îÄ‚îÄ wr.sh                     # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- üîê –í—Å–µ iptables –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–º–µ—á–µ–Ω—ã —Ç–µ–≥–æ–º `WR_RULE` –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìù –°–∫—Ä–∏–ø—Ç—ã —Ç—Ä–µ–±—É—é—Ç –ø—Ä–∞–≤ root (sudo)
- üîÑ IP forwarding –≤–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- üíæ –ü—Ä–∞–≤–∏–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π IP

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ifconfig.me
curl -4s ifconfig.me
# –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É:
curl -4s icanhazip.com
# –ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –≤—Ä—É—á–Ω—É—é –∑–∞–¥–∞–≤ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π SRC_IP:
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∞–≤–∏–ª–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É iptables-persistent
dpkg -l | grep iptables-persistent

# –ü–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤—Ä—É—á–Ω—É—é
sudo iptables-save > /etc/iptables/rules.v4
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ relay

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∫–ª—é—á–µ–Ω –ª–∏ IP forwarding
sysctl net.ipv4.ip_forward

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ iptables
sudo iptables -t nat -L -n -v
sudo iptables -L FORWARD -n -v

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —è–¥—Ä–∞
sudo dmesg | grep -i iptables
```

---

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è pull requests –∏ issues! –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∏–¥–µ–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∏–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –±–∞–≥ ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ issue –Ω–∞ GitHub.

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**.

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).